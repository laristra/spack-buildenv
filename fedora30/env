FROM laristra/spack-buildenv:fedora30_tmp

SHELL ["/bin/bash", "-c"]

ENV DEBIAN_FRONTEND=noninteractive \
    HOME=/home/laristra \
    BASH_ENV=~/.bashrc

USER laristra
WORKDIR $HOME

RUN spack install --show-log-on-error flecsalemm-deps%gcc backend=legion +hdf5 +caliper ^mpich && \
    spack install --show-log-on-error flecsalemm-deps%gcc backend=hpx +hdf5 +caliper ^openmpi && \
    spack clean --all

ENTRYPOINT ["entrypoint.sh"]
CMD ["/bin/bash"]
